#   smobol - Sparse grid and Sobol approximations
#   This file is part of smobol.
#   Copyright 2013 Richard Dwight <richard.dwight@gmail.com>
#
#   smobol is free software: you can redistribute it and/or modify it under the
#   terms of the GNU Lesser General Public License as published by the Free
#   Software Foundation, either version 3 of the License, or (at your option)
#   any later version.
#
#   smobol is distributed in the hope that it will be useful, but WITHOUT ANY
#   WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
#   FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for
#   more details.
#
#   You should have received a copy of the GNU Lesser General Public License
#   along with smobol.  If not, see <http://www.gnu.org/licenses/>.
import numpy as np
from quad_nested import QuadratureNested


class QuadratureCC(QuadratureNested):
    """
    Clenshaw-Curtis quadrature rules in 1d.  All levels are initialized and
    maintained by this class.
    """
    def init_idx(self):
        nlevel = self.nlevel()
        maxidx = self.maxnnode()
        self.idx = []
        for level in range(nlevel):
            if (level == 0):
                center_i = int(maxidx*0.5)
                self.idx.append( np.arange(center_i,center_i+1))
            defc = nlevel-level-1       # = 0 for top level, decreasing
            if (defc == 0):
                self.idx.append( np.arange(0 , maxidx, 1 ) )
            else: 
                if (level > 0):
                    self.idx.append( np.arange(0 , maxidx, 2**defc ) )

    def init_rule(self):
        """Clenshaw-Curtis nodes and weights on [0,1] (rescaling at end of fn)"""
        self.x = [np.array([0.])]       # 1-node rule (level 0)
        self.w = [np.array([2.])]

        self.x.append(np.array(         # 3-node rule (level 1)
                [-1.0, 0.0, 1.0]))
        self.w.append(np.array(
                [0.333333333333333, 1.33333333333333, 0.333333333333333]))

        self.x.append(np.array(         # 5-node rule (level 2)
                [-1.0, -0.707106781186548, 0.0, 0.707106781186548, 1.0]))
        self.w.append(np.array(
               [0.0666666666666670, 0.533333333333333, 0.800000000000000, 
	       0.533333333333333, 0.0666666666666670]))
	    
        self.x.append(np.array(         # 9-node rule (level 3)
                [-1.0, -0.92387953251128696, -0.70710678118654802, 
		-0.38268343236509, 0.0, 0.38268343236509, 
		0.70710678118654802, 0.92387953251128696, 1.0]))
        self.w.append(np.array(
                [0.0158730158730159, 0.14621864921601799, 
		0.27936507936507898, 0.36171785872049, 
		0.39365079365079397, 0.36171785872049, 
		0.27936507936507898, 0.14621864921601799, 
		0.0158730158730159]))

        self.x.append(np.array(         # 17-node rule (level 4) 
           [-1.0, -0.98078528040322999, -0.92387953251128696,
            -0.83146961230254501, -0.70710678118654802,
            -0.55557023301960196, -0.38268343236509, -0.195090322016128,
            0.0, 0.195090322016128, 0.38268343236509, 0.55557023301960196,
            0.70710678118654802, 0.83146961230254501, 0.92387953251128696,
            0.98078528040322999, 1.0]))
        self.w.append(np.array(
	        [0.0039215686274509699, 0.0373687028372056, 
		0.075482331543151801, 0.108905552581891, 
		0.138956468368233, 0.16317266428170299, 
		0.18147378423649299, 0.19251386461292599, 
		0.19641012582189099, 0.19251386461292599, 
		0.18147378423649299, 0.16317266428170299, 
		0.138956468368233, 0.108905552581891, 
		0.075482331543151801, 0.0373687028372056, 
		0.0039215686274509699]))

        self.x.append(np.array(         # 33-node rule (level 5)
                [-1.0, -0.99518472667219704, -0.98078528040322999, 
		-0.95694033573220905, -0.92387953251128696,
		 -0.88192126434835505, -0.83146961230254501, 
		 -0.77301045336273699, -0.70710678118654802, 
		 -0.63439328416364604, -0.55557023301960196, 
		 -0.47139673682599798, -0.38268343236509, 
		 -0.290284677254462, -0.195090322016128, 
		 -0.098017140329560798, 0.0, 0.098017140329560798, 
		 0.195090322016128, 0.290284677254462, 
		 0.38268343236509, 0.47139673682599798, 
		 0.55557023301960196, 0.63439328416364604, 
		 0.70710678118654802, 0.77301045336273699, 
		 0.83146961230254501, 0.88192126434835505,
		 0.92387953251128696, 0.95694033573220905, 
		 0.98078528040322999, 0.99518472667219704, 1.0]))
        self.w.append(np.array(
                [0.00097751710654935095, 0.0093931979629550098, 
		0.019234245132681099, 0.028457916677233699, 
		0.037594341914047202, 0.046262762837751797, 
		0.054555016303980297, 0.062272109545293997, 
		0.069427575630435501, 0.075883800441388496,
		0.081634817654938505, 0.086577538441827404,
		0.090706112867720998, 0.093943244438768697, 
		0.0962923259454882, 0.097698188208055606, 
		0.098178577781768306, 0.097698188208055606,
		0.0962923259454882, 0.093943244438768697, 
		0.090706112867720998, 0.086577538441827404,
		0.081634817654938505, 0.075883800441388496, 
		0.069427575630435501, 0.062272109545293997, 
		0.054555016303980297, 0.046262762837751797, 
		0.037594341914047202, 0.028457916677233699,
		0.019234245132681099, 0.0093931979629550098, 
	        0.00097751710654935095]))
		
	self.x.append(np.array(         # 65-node rule (level 6)
               [-1.0, -0.99879545620517196, 
	       -0.99518472667219704, -0.98917650996478101, 
	       -0.98078528040322999, -0.97003125319454397, 
	       -0.95694033573220905, -0.94154406518302103, 
	       -0.92387953251128696, -0.90398929312344301, 
	       -0.88192126434835505, -0.85772861000027201, 
	       -0.83146961230254501, -0.80320753148064505, 
	       -0.77301045336273699, -0.74095112535495899, 
	       -0.70710678118654802, -0.671558954847018, 
	       -0.63439328416364604, -0.59569930449243402, 
	       -0.55557023301960196, -0.51410274419322199, 
	       -0.47139673682599798, -0.42755509343028197, 
	       -0.38268343236509, -0.33688985339222,
	       -0.290284677254462, -0.24298017990326401, 
	       -0.195090322016128, -0.146730474455362, 
	       -0.098017140329560798, -0.049067674327418098, 
	       0.0, 0.049067674327418098, 0.098017140329560798, 
	       0.146730474455362, 0.195090322016128, 
	       0.24298017990326401, 0.290284677254462, 
	       0.33688985339222, 0.38268343236509, 
	       0.42755509343028197, 0.47139673682599798, 
	       0.51410274419322199, 0.55557023301960196,
	       0.59569930449243402, 0.63439328416364604, 
	       0.671558954847018, 0.70710678118654802, 
	       0.74095112535495899, 0.77301045336273699, 
	       0.80320753148064505, 0.83146961230254501, 
	       0.85772861000027201, 0.88192126434835505, 
	       0.90398929312344301, 0.92387953251128696, 
	       0.94154406518302103, 0.95694033573220905, 
	       0.97003125319454397, 0.98078528040322999, 
	       0.98917650996478101, 0.99518472667219704, 
	       0.99879545620517196, 1.0]))
        self.w.append(np.array(
               [0.00024420024420023, 0.0023514906753117001, 
	       0.0048314654487909099, 0.0071926931617361202, 
	       0.0095823387952837808, 0.0119233947142128, 
	       0.014252060432352, 0.016534987657289599, 
	       0.018786529741795802, 0.020986274429737401, 
	       0.023140694934358198, 0.0252350649817548, 
	       0.027272257141468401, 0.029240653197468301, 
	       0.0311412971040676, 0.0329645465699763, 
	       0.034710498180925101, 0.0363709202866392, 
	       0.037945459921284799, 0.0394269887129561, 
	       0.0408150134003578, 0.042103331111418098, 
	       0.0432915149616908, 0.044374179239257301, 
	       0.045351109551660697, 0.046217667510925597, 
	       0.046973959046614201, 0.047616044585250199, 
	       0.048144432572512198, 0.048555844857141102, 
	       0.048851256643066103, 0.049028018431025597,
	       0.049087623514942502, 0.049028018431025597, 
	       0.048851256643066103, 0.048555844857141102, 
	       0.048144432572512198, 0.047616044585250199, 
	       0.046973959046614201, 0.046217667510925597, 
	       0.045351109551660697, 0.044374179239257301, 
	       0.0432915149616908, 0.042103331111418098, 
	       0.0408150134003578, 0.0394269887129561, 
	       0.037945459921284799, 0.0363709202866392, 
	       0.034710498180925101, 0.0329645465699763, 
	       0.0311412971040676, 0.029240653197468301, 
	       0.027272257141468401, 0.0252350649817548, 
	       0.023140694934358198, 0.020986274429737401, 
	       0.018786529741795802, 0.016534987657289599, 
	       0.014252060432352, 0.0119233947142128,
	       0.0095823387952837808, 0.0071926931617361202, 
	       0.0048314654487909099, 0.0023514906753117001, 
	       0.00024420024420023]))
	       
        self.x.append(np.array( # 129-node rule (level 7)
            [-1.0, -0.99969881869620403, -0.99879545620517196, 
             -0.99729045667868998, -0.99518472667219704, -0.99247953459870997, 
             -0.98917650996478101, -0.985277642388941, -0.98078528040322999, 
             -0.97570213003852901, -0.97003125319454397, -0.96377606579543995, 
             -0.95694033573220905, -0.94952818059303701, -0.94154406518302103, 
             -0.93299279883473896, -0.92387953251128696, -0.91420975570353102, 
             -0.90398929312344301, -0.89322430119551499, -0.88192126434835505, 
             -0.87008699110871202, -0.85772861000027201, -0.84485356524970701, 
             -0.83146961230254501, -0.81758481315158404, -0.80320753148064505, 
             -0.78834642762660601, -0.77301045336273699, -0.75720884650648501, 
             -0.74095112535495899, -0.724247082951467, -0.70710678118654802, 
             -0.68954054473706705, -0.671558954847018, -0.65317284295377698, 
             -0.63439328416364604, -0.61523159058062704, -0.59569930449243402, 
             -0.57580819141784501, -0.55557023301960196, -0.53499761988709704, 
             -0.51410274419322199, -0.49289819222978398, -0.47139673682599798, 
             -0.44961132965460698, -0.42755509343028197, -0.40524131400499003, 
             -0.38268343236509, -0.359895036534988, -0.33688985339222, 
             -0.31368174039889202, -0.290284677254462, -0.26671275747489798, 
             -0.24298017990326401, -0.21910124015686999, -0.195090322016128, 
             -0.170961888760301, -0.146730474455362, -0.122410675199216, 
             -0.098017140329560798, -0.073564563599667496, -0.049067674327418098, 
             -0.024541228522912299, 0.0, 0.024541228522912299, 0.049067674327418098, 
             0.073564563599667496, 0.098017140329560798, 0.122410675199216, 
             0.146730474455362, 0.170961888760301, 0.195090322016128, 
             0.21910124015686999, 0.24298017990326401, 0.26671275747489798, 
             0.290284677254462, 0.31368174039889202, 0.33688985339222, 
             0.359895036534988, 0.38268343236509, 0.40524131400499003, 
             0.42755509343028197, 0.44961132965460698, 0.47139673682599798, 
             0.49289819222978398, 0.51410274419322199, 0.53499761988709704, 
             0.55557023301960196, 0.57580819141784501, 0.59569930449243402, 
             0.61523159058062704, 0.63439328416364604, 0.65317284295377698, 
             0.671558954847018, 0.68954054473706705, 0.70710678118654802, 
             0.724247082951467, 0.74095112535495899, 0.75720884650648501, 
             0.77301045336273699, 0.78834642762660601, 0.80320753148064505,
             0.81758481315158404, 0.83146961230254501, 0.84485356524970701, 
             0.85772861000027201, 0.87008699110871202, 0.88192126434835505, 
             0.89322430119551499, 0.90398929312344301, 0.91420975570353102, 
             0.92387953251128696, 0.93299279883473896, 0.94154406518302103, 
             0.94952818059303701, 0.95694033573220905, 0.96377606579543995, 
             0.97003125319454397, 0.97570213003852901, 0.98078528040322999,
             0.985277642388941, 0.98917650996478101, 0.99247953459870997, 
             0.99518472667219704, 0.99729045667868998, 0.99879545620517196, 
             0.99969881869620403, 1.0]))
        self.w.append(np.array(
            [6.1038881767672097e-05, 0.00058807215382869504,
             0.00120930061875274, 0.00180308126695362, 0.00240715327877141,
             0.00300345869904498, 0.0036019783581261399, 0.00419553798718535,
             0.0047886214334133597, 0.0053772474684018398, 0.0059638803473079901,
             0.0065459084386229899, 0.0071248333232549, 0.0076987577889608199,
             0.00826865154203087, 0.0088330386747013292, 0.0093925658393481503,
             0.0099460278492345799, 0.010493862025768901, 0.011035048774272501,
             0.011569883482908499, 0.012097480528071599, 0.0126180359797774,
             0.013130765166939701, 0.013635793212937701, 0.0141324143785309,
             0.014620702546343499, 0.015100015724792699, 0.0155703907389943,
             0.016031238587450598, 0.0164825695622038, 0.016923839858465,
             0.017355041254113999, 0.017775669388752802, 0.018185703779263401,
             0.018584675195669101, 0.018972555870679499, 0.019348908423924501,
             0.0197137018370016, 0.020066528051983602, 0.020407356120038699,
             0.020735805334901498, 0.021051847590020101, 0.021355127974259699,
             0.021645623567128802, 0.021923004005987599, 0.022187253558972001,
             0.022438065397226301, 0.022675432704566699, 0.022899071343906102,
             0.023108984916274101, 0.023304911261311401, 0.0234868657119316,
             0.023654607460577699, 0.023808164730242599, 0.023947317504769,
             0.024072107923278501, 0.024182336238931498, 0.024278059420757499,
             0.0243590974892764, 0.0244255230615671, 0.024477175427434401,
             0.0245141435888157, 0.024536285596514999, 0.024543707505514201,
             0.024536285596514999, 0.0245141435888157, 0.024477175427434401,
             0.0244255230615671, 0.0243590974892764, 0.024278059420757499,
             0.024182336238931498, 0.024072107923278501, 0.023947317504769,
             0.023808164730242599, 0.023654607460577699, 0.0234868657119316,
             0.023304911261311401, 0.023108984916274101, 0.022899071343906102,
             0.022675432704566699, 0.022438065397226301, 0.022187253558972001,
             0.021923004005987599, 0.021645623567128802, 0.021355127974259699,
             0.021051847590020101, 0.020735805334901498, 0.020407356120038699,
             0.020066528051983602, 0.0197137018370016, 0.019348908423924501,
             0.018972555870679499, 0.018584675195669101, 0.018185703779263401,
             0.017775669388752802, 0.017355041254113999, 0.016923839858465,
             0.0164825695622038, 0.016031238587450598, 0.0155703907389943,
             0.015100015724792699, 0.014620702546343499, 0.0141324143785309,
             0.013635793212937701, 0.013130765166939701, 0.0126180359797774,
             0.012097480528071599, 0.011569883482908499, 0.011035048774272501,
             0.010493862025768901, 0.0099460278492345799, 0.0093925658393481503,
             0.0088330386747013292, 0.00826865154203087, 0.0076987577889608199,
             0.0071248333232549, 0.0065459084386229899, 0.0059638803473079901,
             0.0053772474684018398, 0.0047886214334133597, 0.00419553798718535,
             0.0036019783581261399, 0.00300345869904498, 0.00240715327877141,
             0.00180308126695362, 0.00120930061875274, 0.00058807215382869504,
             6.1038881767672097e-05]))
	       
	self.x.append(np.array( # 257-node rule (level 8)
            [-1.0,
             -0.99992470183914495, -0.99969881869620403, -0.99932238458834999,
             -0.99879545620517196, -0.99811811290014896, -0.99729045667868998,
             -0.996312612182778, -0.99518472667219704, -0.99390697000235595,
             -0.99247953459870997, -0.99090263542778001, -0.98917650996478101,
             -0.98730141815785799, -0.985277642388941, -0.98310548743121595,
             -0.98078528040322999, -0.97831737071962799, -0.97570213003852901,
             -0.97293995220555995, -0.97003125319454397, -0.96697647104485196,
             -0.96377606579543995, -0.96043051941556601, -0.95694033573220905,
             -0.95330604035419397, -0.94952818059303701, -0.94560732538052095,
             -0.94154406518302103, -0.93733901191257496, -0.93299279883473896,
             -0.92850608047321603, -0.92387953251128696, -0.91911385169005799,
             -0.91420975570353102, -0.90916798309052205, -0.90398929312344301,
             -0.89867446569395404, -0.89322430119551499, -0.88763962040285405,
             -0.88192126434835505, -0.87607009419540705, -0.87008699110871202,
             -0.86397285612158703, -0.85772861000027201, -0.85135519310526497,
             -0.84485356524970701, -0.83822470555483797, -0.83146961230254501,
             -0.82458930278502496, -0.81758481315158404, -0.81045719825259499,
             -0.80320753148064505, -0.79583690460888401, -0.78834642762660601,
             -0.78073722857209504, -0.77301045336273699, -0.76516726562245896,
             -0.75720884650648501, -0.74913639452345904, -0.74095112535495899,
             -0.73265427167241304, -0.724247082951467, -0.71573082528381904,
             -0.70710678118654802, -0.69837624940897303, -0.68954054473706705,
             -0.68060099779545302, -0.671558954847018, -0.66241577759017201,
             -0.65317284295377698, -0.64383154288979205, -0.63439328416364604,
             -0.62485948814238701, -0.61523159058062704, -0.60551104140432599,
             -0.59569930449243402, -0.58579785745643898, -0.57580819141784501,
             -0.56573181078361301, -0.55557023301960196, -0.54532498842204702,
             -0.53499761988709704, -0.52458968267846895, -0.51410274419322199,
             -0.50353838372571802, -0.49289819222978398, -0.482183772079123,
             -0.47139673682599798, -0.46053871095824001, -0.44961132965460698,
             -0.43861623853852799, -0.42755509343028197, -0.41642956009763699,
             -0.40524131400499003, -0.39399204006104799, -0.38268343236509,
             -0.37131719395183799, -0.359895036534988, -0.34841868024943501,
             -0.33688985339222, -0.32531029216226298, -0.31368174039889202,
             -0.30200594931922797, -0.290284677254462, -0.278519689385053,
             -0.26671275747489798, -0.25486565960451502, -0.24298017990326401,
             -0.231058108280671, -0.21910124015686999, -0.207111376192219,
             -0.195090322016128, -0.18303988795514101, -0.170961888760301,
             -0.158858143333861, -0.146730474455362, -0.134580708507126,
             -0.122410675199216, -0.110222207293883, -0.098017140329560798,
             -0.085797312344439894, -0.073564563599667496,
             -0.061320736302208703, -0.049067674327418098,
             -0.036807222941358998, -0.024541228522912299,
             -0.012271538285719899, 0.0, 0.012271538285719899,
             0.024541228522912299, 0.036807222941358998, 0.049067674327418098,
             0.061320736302208703, 0.073564563599667496, 0.085797312344439894,
             0.098017140329560798, 0.110222207293883, 0.122410675199216,
             0.134580708507126, 0.146730474455362, 0.158858143333861,
             0.170961888760301, 0.18303988795514101, 0.195090322016128,
             0.207111376192219, 0.21910124015686999, 0.231058108280671,
             0.24298017990326401, 0.25486565960451502, 0.26671275747489798,
             0.278519689385053, 0.290284677254462, 0.30200594931922797,
             0.31368174039889202, 0.32531029216226298, 0.33688985339222,
             0.34841868024943501, 0.359895036534988, 0.37131719395183799,
             0.38268343236509, 0.39399204006104799, 0.40524131400499003,
             0.41642956009763699, 0.42755509343028197, 0.43861623853852799,
             0.44961132965460698, 0.46053871095824001, 0.47139673682599798,
             0.482183772079123, 0.49289819222978398, 0.50353838372571802,
             0.51410274419322199, 0.52458968267846895, 0.53499761988709704,
             0.54532498842204702, 0.55557023301960196, 0.56573181078361301,
             0.57580819141784501, 0.58579785745643898, 0.59569930449243402,
             0.60551104140432599, 0.61523159058062704, 0.62485948814238701,
             0.63439328416364604, 0.64383154288979205, 0.65317284295377698,
             0.66241577759017201, 0.671558954847018, 0.68060099779545302,
             0.68954054473706705, 0.69837624940897303, 0.70710678118654802,
             0.71573082528381904, 0.724247082951467, 0.73265427167241304,
             0.74095112535495899, 0.74913639452345904, 0.75720884650648501,
             0.76516726562245896, 0.77301045336273699, 0.78073722857209504,
             0.78834642762660601, 0.79583690460888401, 0.80320753148064505,
             0.81045719825259499, 0.81758481315158404, 0.82458930278502496,
             0.83146961230254501, 0.83822470555483797, 0.84485356524970701,
             0.85135519310526497, 0.85772861000027201, 0.86397285612158703,
             0.87008699110871202, 0.87607009419540705, 0.88192126434835505,
             0.88763962040285405, 0.89322430119551499, 0.89867446569395404,
             0.90398929312344301, 0.90916798309052205, 0.91420975570353102,
             0.91911385169005799, 0.92387953251128696, 0.92850608047321603,
             0.93299279883473896, 0.93733901191257496, 0.94154406518302103,
             0.94560732538052095, 0.94952818059303701, 0.95330604035419397,
             0.95694033573220905, 0.96043051941556601, 0.96377606579543995,
             0.96697647104485196, 0.97003125319454397, 0.97293995220555995,
             0.97570213003852901, 0.97831737071962799, 0.98078528040322999,
             0.98310548743121595, 0.985277642388941, 0.98730141815785799,
             0.98917650996478101, 0.99090263542778001, 0.99247953459870997,
             0.99390697000235595, 0.99518472667219704, 0.996312612182778,
             0.99729045667868998, 0.99811811290014896, 0.99879545620517196,
             0.99932238458834999, 0.99969881869620403, 0.99992470183914495,
             1.0 ]))
        self.w.append(np.array(
            [1.52590218966825e-05, 0.00014703050683216199,
             0.00030241483866181099, 0.00045107737222924502,
             0.00060251267297587797, 0.00075228178519207904,
             0.00090293974108745199, 0.00105276786505254, 0.00120294646714376,
             0.00135255443179264, 0.0015022664164212501, 0.0016515028495657899,
             0.00180069673385487, 0.0019494460719054699, 0.0020980496948200902,
             0.0022462097203661, 0.0023941428040393101, 0.0025416173530766199,
             0.0026887960740274298, 0.0028354922041288599,
             0.0029818311509036801, 0.0031276579029355001,
             0.0032730710274963999, 0.0034179388411490902, 0.00356233997347506,
             0.0037061604004926499, 0.0038494635551849102, 0.00399214911961078,
             0.0041342686958207803, 0.00427573283170859, 0.00441658375488668,
             0.0045567407870233502, 0.0046962386172294101,
             0.0048350037667719897, 0.0049730647868562504,
             0.0051103541918902104, 0.0052468954830308997,
             0.0053826262282910204, 0.0055175657372630799, 0.00565165588957048,
             0.0057849124903858896, 0.0059172811376676697,
             0.0060487746892257596, 0.0061793419817558603,
             0.0063089933825440101, 0.0064376805755111399,
             0.0065654118160297804, 0.0066921413128292898,
             0.0068178755261836498, 0.0069425709220159596,
             0.0070662324329687897, 0.0071888185584477399,
             0.0073103329311293404, 0.0074307358956846098,
             0.0075500299800912701, 0.0076681772150035098, 0.00778517919237115,
             0.0079009994933161506, 0.0080156389204251704,
             0.0081290624894300601, 0.0082412703418762601,
             0.0083522288286093302, 0.0084619375430605905,
             0.0085703640853903498, 0.0086775076008381007,
             0.0087833368646069599, 0.0088878506626138207,
             0.0089910188805796005, 0.0090928400245189507,
             0.0091932850344231508, 0.0092923522077027008,
             0.0093900134894286894, 0.0094862670326870992,
             0.0095810857444751894, 0.0096744676917388701,
             0.0097663867054280495, 0.0098568408192139401,
             0.0099458047544820592, 0.0100332765598313, 0.010119231817408,
             0.0102036686348348, 0.010286563428662399, 0.0103679144060022,
             0.0104476987943224, 0.010525914937463099, 0.0106025408528066,
             0.0106775750552875, 0.0107509963333481, 0.010822803404809799,
             0.010892975812181601, 0.010961512505653101, 0.0110283937664135,
             0.0110936188044194, 0.011157168625541201, 0.0112190427250168,
             0.0112792228205911, 0.011337708716589401, 0.011394482830846099,
             0.0114495452990242, 0.011502879228133801, 0.0115544851060064,
             0.011604346718649501, 0.011652464925595799, 0.0116988241822881,
             0.0117434257383023, 0.0117862547094625, 0.011827312752635599,
             0.011866585635384499, 0.011904075438108201, 0.011939768571789701,
             0.0119736675556722, 0.0120057594360851, 0.0120360471855715,
             0.0120645184779041, 0.012091176752591399, 0.0121160103030511,
             0.012139023048692099, 0.0121602038948221, 0.012179557253011499,
             0.0121970726326885, 0.0122127549492255, 0.0122265943083332,
             0.012238596140254999, 0.012248751139027399, 0.0122570652603111,
             0.012263529778343401, 0.0122681511842709, 0.012270921324193799,
             0.0122718472343793, 0.012270921324193799, 0.0122681511842709,
             0.012263529778343401, 0.0122570652603111, 0.012248751139027399,
             0.012238596140254999, 0.0122265943083332, 0.0122127549492255,
             0.0121970726326885, 0.012179557253011499, 0.0121602038948221,
             0.012139023048692099, 0.0121160103030511, 0.012091176752591399,
             0.0120645184779041, 0.0120360471855715, 0.0120057594360851,
             0.0119736675556722, 0.011939768571789701, 0.011904075438108201,
             0.011866585635384499, 0.011827312752635599, 0.0117862547094625,
             0.0117434257383023, 0.0116988241822881, 0.011652464925595799,
             0.011604346718649501, 0.0115544851060064, 0.011502879228133801,
             0.0114495452990242, 0.011394482830846099, 0.011337708716589401,
             0.0112792228205911, 0.0112190427250168, 0.011157168625541201,
             0.0110936188044194, 0.0110283937664135, 0.010961512505653101,
             0.010892975812181601, 0.010822803404809799, 0.0107509963333481,
             0.0106775750552875, 0.0106025408528066, 0.010525914937463099,
             0.0104476987943224, 0.0103679144060022, 0.010286563428662399,
             0.0102036686348348, 0.010119231817408, 0.0100332765598313,
             0.0099458047544820592, 0.0098568408192139401,
             0.0097663867054280495, 0.0096744676917388701,
             0.0095810857444751894, 0.0094862670326870992,
             0.0093900134894286894, 0.0092923522077027008,
             0.0091932850344231508, 0.0090928400245189507,
             0.0089910188805796005, 0.0088878506626138207,
             0.0087833368646069599, 0.0086775076008381007,
             0.0085703640853903498, 0.0084619375430605905,
             0.0083522288286093302, 0.0082412703418762601,
             0.0081290624894300601, 0.0080156389204251704,
             0.0079009994933161506, 0.00778517919237115, 0.0076681772150035098,
             0.0075500299800912701, 0.0074307358956846098,
             0.0073103329311293404, 0.0071888185584477399,
             0.0070662324329687897, 0.0069425709220159596,
             0.0068178755261836498, 0.0066921413128292898,
             0.0065654118160297804, 0.0064376805755111399,
             0.0063089933825440101, 0.0061793419817558603,
             0.0060487746892257596, 0.0059172811376676697,
             0.0057849124903858896, 0.00565165588957048, 0.0055175657372630799,
             0.0053826262282910204, 0.0052468954830308997,
             0.0051103541918902104, 0.0049730647868562504,
             0.0048350037667719897, 0.0046962386172294101,
             0.0045567407870233502, 0.00441658375488668, 0.00427573283170859,
             0.0041342686958207803, 0.00399214911961078, 0.0038494635551849102,
             0.0037061604004926499, 0.00356233997347506, 0.0034179388411490902,
             0.0032730710274963999, 0.0031276579029355001,
             0.0029818311509036801, 0.0028354922041288599,
             0.0026887960740274298, 0.0025416173530766199,
             0.0023941428040393101, 0.0022462097203661, 0.0020980496948200902,
             0.0019494460719054699, 0.00180069673385487, 0.0016515028495657899,
             0.0015022664164212501, 0.00135255443179264, 0.00120294646714376,
             0.00105276786505254, 0.00090293974108745199,
             0.00075228178519207904, 0.00060251267297587797,
             0.00045107737222924502, 0.00030241483866181099,
             0.00014703050683216199, 1.52590218966825e-05]))

	self.x.append(np.array( # 513-node rule (level 9) 
           [-1.0,
            -0.999981175282601, -0.99992470183914495, -0.99983058179582296,
            -0.99969881869620403, -0.99952941750109303, -0.99932238458834999,
            -0.99907772775264503, -0.99879545620517196, -0.998475580573295,
            -0.99811811290014896, -0.99772306664419197, -0.99729045667868998,
            -0.996820299291166, -0.996312612182778, -0.99576741446766004,
            -0.99518472667219704, -0.99456457073425497, -0.99390697000235595,
            -0.99321194923479506, -0.99247953459870997, -0.99170975366909997,
            -0.99090263542778001, -0.99005821026229701, -0.98917650996478101,
            -0.98825756773075002, -0.98730141815785799, -0.986308097244599,
            -0.985277642388941, -0.98421009238692903, -0.98310548743121595,
            -0.98196386910955502, -0.98078528040322999, -0.97956976568544096,
            -0.97831737071962799, -0.97702814265775395, -0.97570213003852901,
            -0.97433938278557597, -0.97293995220555995, -0.97150389098625201,
            -0.97003125319454397, -0.96852209427441704, -0.96697647104485196,
            -0.96539444169768895, -0.96377606579543995, -0.96212140426904202,
            -0.96043051941556601, -0.95870347489587204, -0.95694033573220905,
            -0.955141168305771, -0.95330604035419397, -0.95143502096900801,
            -0.94952818059303701, -0.94758559101774098, -0.94560732538052095,
            -0.94359345816196005, -0.94154406518302103, -0.93945922360219003,
            -0.93733901191257496, -0.93518350993894805, -0.93299279883473896,
            -0.93076696107898405, -0.92850608047321603, -0.92621024213831105,
            -0.92387953251128696, -0.92151403934204201, -0.91911385169005799,
            -0.91667905992104304, -0.91420975570353102, -0.91170603200542999,
            -0.90916798309052205, -0.906595704514915, -0.90398929312344301,
            -0.90134884704602203, -0.89867446569395404, -0.895966249756185,
            -0.89322430119551499, -0.89044872324475799, -0.88763962040285405,
            -0.88479709843093801, -0.88192126434835505, -0.87901222642863397,
            -0.87607009419540705, -0.87309497841828998, -0.87008699110871202,
            -0.86704624551569298, -0.86397285612158703, -0.86086693863776698,
            -0.85772861000027201, -0.85455798836540098, -0.85135519310526497,
            -0.84812034480329701, -0.84485356524970701, -0.841554977436898,
            -0.83822470555483797, -0.83486287498638001, -0.83146961230254501,
            -0.82804504525775602, -0.82458930278502496, -0.82110251499110498,
            -0.81758481315158404, -0.81403632970594797, -0.81045719825259499,
            -0.806847553543799, -0.80320753148064505, -0.79953726910790501,
            -0.79583690460888401, -0.79210657730021194, -0.78834642762660601,
            -0.78455659715557502, -0.78073722857209504, -0.776888465673232,
            -0.77301045336273699, -0.76910333764558003, -0.76516726562245896,
            -0.761202385484262, -0.75720884650648501, -0.75318679904361296,
            -0.74913639452345904, -0.74505778544146595, -0.74095112535495899,
            -0.73681656887737002, -0.73265427167241304, -0.72846439044822497,
            -0.724247082951467, -0.72000250796138199, -0.71573082528381904,
            -0.71143219574521599, -0.70710678118654802, -0.70275474445722497,
            -0.69837624940897303, -0.693971460889654, -0.68954054473706705,
            -0.68508366777270002, -0.68060099779545302, -0.67609270357531603,
            -0.671558954847018, -0.66699992230363803, -0.66241577759017201,
            -0.65780669329707897, -0.65317284295377698, -0.648514401022113,
            -0.64383154288979205, -0.63912444486377595, -0.63439328416364604,
            -0.62963823891492698, -0.62485948814238701, -0.62005721176328898,
            -0.61523159058062704, -0.61038280627631003, -0.60551104140432599,
            -0.60061647938386897, -0.59569930449243402, -0.59075970185887405,
            -0.58579785745643898, -0.58081395809576497, -0.57580819141784501,
            -0.57078074588696703, -0.56573181078361301, -0.56066157619733603,
            -0.55557023301960196, -0.55045797293660503, -0.54532498842204702,
            -0.54017147272989297, -0.53499761988709704, -0.52980362468629505,
            -0.52458968267846895, -0.51935599016558998, -0.51410274419322199,
            -0.50883014254310699, -0.50353838372571802, -0.49822766697278198,
            -0.49289819222978398, -0.487550160148436, -0.482183772079123,
            -0.47679923006332198, -0.47139673682599798, -0.46597649576796601,
            -0.46053871095824001, -0.455083587126344, -0.44961132965460698,
            -0.44412214457042898, -0.43861623853852799, -0.43309381885315201,
            -0.42755509343028197, -0.42200027079980001, -0.41642956009763699,
            -0.41084317105790402, -0.40524131400499003, -0.39962419984564701,
            -0.39399204006104799, -0.38834504669882602, -0.38268343236509,
            -0.37700741021641798, -0.37131719395183799, -0.36561299780477402,
            -0.359895036534988, -0.35416352542049101, -0.34841868024943501,
            -0.34266071731199399, -0.33688985339222, -0.33110630575987599,
            -0.32531029216226298, -0.31950203081601602, -0.31368174039889202,
            -0.30784964004153498, -0.30200594931922797, -0.29615088824362401,
            -0.290284677254462, -0.28440753721127199, -0.278519689385053,
            -0.27262135544994898, -0.26671275747489798, -0.26079411791527601,
            -0.25486565960451502, -0.24892760574572001, -0.24298017990326401,
            -0.237023605994367, -0.231058108280671, -0.225083911359793,
            -0.21910124015686999, -0.213110319916091, -0.207111376192219,
            -0.20110463484209201, -0.195090322016128, -0.189068664149806,
            -0.18303988795514101, -0.177004220412149, -0.170961888760301,
            -0.16491312048997001, -0.158858143333861, -0.15279718525844299,
            -0.146730474455362, -0.14065823933284899, -0.134580708507126,
            -0.128498110793793, -0.122410675199216, -0.116318630911905,
            -0.110222207293883, -0.104121633872055, -0.098017140329560798,
            -0.091908956497132696, -0.085797312344439894,
            -0.079682437971430098, -0.073564563599667496,
            -0.067443919563664106, -0.061320736302208703,
            -0.055195244349689997, -0.049067674327418098,
            -0.042938256934941001, -0.036807222941358998,
            -0.030674803176636602, -0.024541228522912299,
            -0.018406729905804799, -0.012271538285719899,
            -0.0061358846491545204, 0.0, 0.0061358846491545204,
            0.012271538285719899, 0.018406729905804799, 0.024541228522912299,
            0.030674803176636602, 0.036807222941358998, 0.042938256934941001,
            0.049067674327418098, 0.055195244349689997, 0.061320736302208703,
            0.067443919563664106, 0.073564563599667496, 0.079682437971430098,
            0.085797312344439894, 0.091908956497132696, 0.098017140329560798,
            0.104121633872055, 0.110222207293883, 0.116318630911905,
            0.122410675199216, 0.128498110793793, 0.134580708507126,
            0.14065823933284899, 0.146730474455362, 0.15279718525844299,
            0.158858143333861, 0.16491312048997001, 0.170961888760301,
            0.177004220412149, 0.18303988795514101, 0.189068664149806,
            0.195090322016128, 0.20110463484209201, 0.207111376192219,
            0.213110319916091, 0.21910124015686999, 0.225083911359793,
            0.231058108280671, 0.237023605994367, 0.24298017990326401,
            0.24892760574572001, 0.25486565960451502, 0.26079411791527601,
            0.26671275747489798, 0.27262135544994898, 0.278519689385053,
            0.28440753721127199, 0.290284677254462, 0.29615088824362401,
            0.30200594931922797, 0.30784964004153498, 0.31368174039889202,
            0.31950203081601602, 0.32531029216226298, 0.33110630575987599,
            0.33688985339222, 0.34266071731199399, 0.34841868024943501,
            0.35416352542049101, 0.359895036534988, 0.36561299780477402,
            0.37131719395183799, 0.37700741021641798, 0.38268343236509,
            0.38834504669882602, 0.39399204006104799, 0.39962419984564701,
            0.40524131400499003, 0.41084317105790402, 0.41642956009763699,
            0.42200027079980001, 0.42755509343028197, 0.43309381885315201,
            0.43861623853852799, 0.44412214457042898, 0.44961132965460698,
            0.455083587126344, 0.46053871095824001, 0.46597649576796601,
            0.47139673682599798, 0.47679923006332198, 0.482183772079123,
            0.487550160148436, 0.49289819222978398, 0.49822766697278198,
            0.50353838372571802, 0.50883014254310699, 0.51410274419322199,
            0.51935599016558998, 0.52458968267846895, 0.52980362468629505,
            0.53499761988709704, 0.54017147272989297, 0.54532498842204702,
            0.55045797293660503, 0.55557023301960196, 0.56066157619733603,
            0.56573181078361301, 0.57078074588696703, 0.57580819141784501,
            0.58081395809576497, 0.58579785745643898, 0.59075970185887405,
            0.59569930449243402, 0.60061647938386897, 0.60551104140432599,
            0.61038280627631003, 0.61523159058062704, 0.62005721176328898,
            0.62485948814238701, 0.62963823891492698, 0.63439328416364604,
            0.63912444486377595, 0.64383154288979205, 0.648514401022113,
            0.65317284295377698, 0.65780669329707897, 0.66241577759017201,
            0.66699992230363803, 0.671558954847018, 0.67609270357531603,
            0.68060099779545302, 0.68508366777270002, 0.68954054473706705,
            0.693971460889654, 0.69837624940897303, 0.70275474445722497,
            0.70710678118654802, 0.71143219574521599, 0.71573082528381904,
            0.72000250796138199, 0.724247082951467, 0.72846439044822497,
            0.73265427167241304, 0.73681656887737002, 0.74095112535495899,
            0.74505778544146595, 0.74913639452345904, 0.75318679904361296,
            0.75720884650648501, 0.761202385484262, 0.76516726562245896,
            0.76910333764558003, 0.77301045336273699, 0.776888465673232,
            0.78073722857209504, 0.78455659715557502, 0.78834642762660601,
            0.79210657730021194, 0.79583690460888401, 0.79953726910790501,
            0.80320753148064505, 0.806847553543799, 0.81045719825259499,
            0.81403632970594797, 0.81758481315158404, 0.82110251499110498,
            0.82458930278502496, 0.82804504525775602, 0.83146961230254501,
            0.83486287498638001, 0.83822470555483797, 0.841554977436898,
            0.84485356524970701, 0.84812034480329701, 0.85135519310526497,
            0.85455798836540098, 0.85772861000027201, 0.86086693863776698,
            0.86397285612158703, 0.86704624551569298, 0.87008699110871202,
            0.87309497841828998, 0.87607009419540705, 0.87901222642863397,
            0.88192126434835505, 0.88479709843093801, 0.88763962040285405,
            0.89044872324475799, 0.89322430119551499, 0.895966249756185,
            0.89867446569395404, 0.90134884704602203, 0.90398929312344301,
            0.906595704514915, 0.90916798309052205, 0.91170603200542999,
            0.91420975570353102, 0.91667905992104304, 0.91911385169005799,
            0.92151403934204201, 0.92387953251128696, 0.92621024213831105,
            0.92850608047321603, 0.93076696107898405, 0.93299279883473896,
            0.93518350993894805, 0.93733901191257496, 0.93945922360219003,
            0.94154406518302103, 0.94359345816196005, 0.94560732538052095,
            0.94758559101774098, 0.94952818059303701, 0.95143502096900801,
            0.95330604035419397, 0.955141168305771, 0.95694033573220905,
            0.95870347489587204, 0.96043051941556601, 0.96212140426904202,
            0.96377606579543995, 0.96539444169768895, 0.96697647104485196,
            0.96852209427441704, 0.97003125319454397, 0.97150389098625201,
            0.97293995220555995, 0.97433938278557597, 0.97570213003852901,
            0.97702814265775395, 0.97831737071962799, 0.97956976568544096,
            0.98078528040322999, 0.98196386910955502, 0.98310548743121595,
            0.98421009238692903, 0.985277642388941, 0.986308097244599,
            0.98730141815785799, 0.98825756773075002, 0.98917650996478101,
            0.99005821026229701, 0.99090263542778001, 0.99170975366909997,
            0.99247953459870997, 0.99321194923479506, 0.99390697000235595,
            0.99456457073425497, 0.99518472667219704, 0.99576741446766004,
            0.996312612182778, 0.996820299291166, 0.99729045667868998,
            0.99772306664419197, 0.99811811290014896, 0.998475580573295,
            0.99879545620517196, 0.99907772775264503, 0.99932238458834999,
            0.99952941750109303, 0.99969881869620403, 0.99983058179582296,
            0.99992470183914495, 0.999981175282601, 1.0]))
        self.w.append(np.array(
            [3.81471181758186e-06, 3.6758405990266602e-05,
             7.5609315584839403e-05, 0.00011278853882436201,
             0.00015067346092076001, 0.00018815907804198401,
             0.00022588791300103599, 0.00026343501249824199,
             0.00030109921650763998, 0.00033865494764251901,
             0.00037627462290389801, 0.00041381803609336402,
             0.00045139717599785098, 0.00048891621293663105,
             0.00052645357440305005, 0.00056393943987660905,
             0.000601431670945403, 0.00063887699702641697,
             0.00067631976701736595, 0.00071371789252934405,
             0.000751106368877295, 0.00078845101729864604,
             0.00082578009089766095, 0.00086306521178616303,
             0.00090032961321354099, 0.00093754929813201797,
             0.000974743661956659, 0.00101189209723806, 0.00104901099975,
             0.00108608243872211, 0.00112312042121534, 0.00116010916727993,
             0.00119706075108122, 0.00123396114713071, 0.0012708208437091899,
             0.0013076272653904999, 0.00134438958342722, 0.0013810964348205501,
             0.00141775588533881, 0.0014543575961973099, 0.00149090869642164,
             0.00152739972044591, 0.0015638369968063301, 0.0016002118106207301,
             0.0016365298011697699, 0.0016727829037842101, 0.00170897616020232,
             0.00174510207281587, 0.0017811651621228201, 0.00181715842817174,
             0.00185308593422461, 0.00188894111960767, 0.0019247276444412701,
             0.0019604393378750799, 0.0019960795029244699, 0.00203164231639524,
             0.0020671307636284399, 0.0021025393329158499, 0.00213787072589754,
             0.0021731197111528101, 0.0022082887360539301, 0.0022433728224190001,
             0.0022783741889835199, 0.00231328808724125, 0.0023481165297184999,
             0.0023828549769665101, 0.0024175052550154002, 0.00245206301535766,
             0.00248652991492768, 0.00252090178017944, 0.0025551801143720602,
             0.0025893609047745601, 0.0026234455146880698, 0.0026574300796303198,
             0.0026913158351901099, 0.0027250990539355001, 0.0027587808547117698,
             0.0027923576371277499, 0.00282583041314178, 0.0028591957004311902,
             0.00289245441295143, 0.0029256031783842498, 0.0029586428207129399,
             0.00299157007035751, 0.0030243856686085701, 0.0030570864420615398,
             0.0030896730559302, 0.00312214242704435, 0.0031544951505689599,
             0.0031867282281785201, 0.00321884219049483, 0.0032508341191376201,
             0.0032827044852257602, 0.0033144504458618301, 0.0033460724172862501,
             0.0033775676280126199, 0.00340893644365496, 0.0034401761604160898,
             0.0034712870972013099, 0.0035022666144950199, 0.0035331149881106302,
             0.0035638296396892401, 0.00359441080529778, 0.00362485596486421,
             0.0036551653178090401, 0.00368533639970758, 0.00371536937621183,
             0.0037452618361135601, 0.0037750139139723698, 0.0038046232495547701,
             0.00383408994882075, 0.0038634117004416298, 0.0038925885841034399,
             0.0039216183354687899, 0.00395050101012285, 0.0039792343889485902,
             0.0040078185054639301, 0.0040362511841313198, 0.0040645324383073601,
             0.0040926601345120496, 0.0041206342677293801, 0.0041484527451238597,
             0.0041761155449878701, 0.0042036206138172296, 0.0042309679147946198,
             0.0042581554325255297, 0.0042851831165735101, 0.0043120489885162304,
             0.00433875298570439, 0.0043652931656277998, 0.0043916694547526097,
             0.0044178799454920696, 0.0044439245546838901, 0.0044698014087417798,
             0.0044955104160643196, 0.0045210497362033197, 0.0045464192702454401,
             0.0045716172100742896, 0.0045966434505341196, 0.0046214962150858303,
             0.0046461753933470899, 0.00467067923964949, 0.0046950076393499299,
             0.0047191588769884803, 0.0047431328345804002, 0.0047669278262531603,
             0.00479054373155591, 0.0048139788936205196, 0.0048372331903648704,
             0.0048603049933776, 0.00488319417974197, 0.0049058991489885802,
             0.0049284197781270097, 0.0049507544941454701, 0.0049729031747072199,
             0.0049948642738021302, 0.0050166376704429798, 0.0050382218451916101,
             0.0050596166790765904, 0.0050808206788265399, 0.00510183372812416,
             0.0051226543594824299, 0.0051432824598503001, 0.0051637165871638397,
             0.00518395663222558, 0.0052040011780531397, 0.0052238501198665398,
             0.0052435020654417498, 0.0052629569149581102, 0.0052822133006437998,
             0.0053012711281584003, 0.0053201290538919897, 0.0053387869894855697,
             0.0053572436152155498, 0.0053754988491867602, 0.0053935513953001397,
             0.0054114011785889298, 0.0054290469263295702, 0.0054464885709314299,
             0.0054637248628092699, 0.0054807557421802603, 0.0054975799823712901,
             0.0055141975318237901, 0.0055306071865607901, 0.0055468089036499199,
             0.00556280150160386, 0.0055785849465045103, 0.0055941580791565096,
             0.0056095208750309702, 0.0056246721970348804, 0.0056396120303909203,
             0.00565433925992635, 0.0056688538809657896, 0.0056831548000816001,
             0.0056972420230392501, 0.0057111144779874402, 0.0057247721814604104,
             0.00573821408302028, 0.0057514402102876103, 0.0057644495340803499,
             0.0057772420934128097, 0.0057898168802061603, 0.00580217394516636,
             0.0058143123011696303, 0.0058262320109022199, 0.0058379321080513098,
             0.0058494126675633397, 0.00586067274379599, 0.0058717124242273003,
             0.0058825307837483297, 0.00589312792263204, 0.0059035029361686302,
             0.0059136559376815603, 0.0059235860427285696, 0.0059332933779316496,
             0.00594277707898679, 0.0059520372860554296, 0.0059610731548444297,
             0.0059698848392886897, 0.00597847151498033, 0.0059868333498550403,
             0.0059949695392659498, 0.0060028802653706199, 0.00601056474316002,
             0.0060180231692284897, 0.0060252547780826502, 0.0060322597809626096,
             0.00603903743176903, 0.0060455879565912201, 0.0060519106286026098,
             0.0060580056889397004, 0.0060638724299276496, 0.0060695111079428999,
             0.0060749210343411996, 0.0060801024809267199, 0.0060850547779643903,
             0.0060897782128690597, 0.0060942721346929699, 0.0060985368466400201,
             0.0061025717164271704, 0.0061063770632213297, 0.0061099522732807202,
             0.0061132976819050101, 0.0061164126937691202, 0.0061192976604711501,
             0.0061219520049769598, 0.0061243760953449099, 0.0061265693727045097,
             0.0061285322217325298, 0.0061302641015932701, 0.0061317654137365502,
             0.0061330356352307797, 0.0061340751844500899, 0.0061348835562343197,
             0.0061354611860300898, 0.00613580758631385, 0.0061359232097497798,
             0.00613580758631385, 0.0061354611860300898, 0.0061348835562343197,
             0.0061340751844500899, 0.0061330356352307797, 0.0061317654137365502,
             0.0061302641015932701, 0.0061285322217325298, 0.0061265693727045097,
             0.0061243760953449099, 0.0061219520049769598, 0.0061192976604711501,
             0.0061164126937691202, 0.0061132976819050101, 0.0061099522732807202,
             0.0061063770632213297, 0.0061025717164271704, 0.0060985368466400201,
             0.0060942721346929699, 0.0060897782128690597, 0.0060850547779643903,
             0.0060801024809267199, 0.0060749210343411996, 0.0060695111079428999,
             0.0060638724299276496, 0.0060580056889397004, 0.0060519106286026098,
             0.0060455879565912201, 0.00603903743176903, 0.0060322597809626096,
             0.0060252547780826502, 0.0060180231692284897, 0.00601056474316002,
             0.0060028802653706199, 0.0059949695392659498, 0.0059868333498550403,
             0.00597847151498033, 0.0059698848392886897, 0.0059610731548444297,
             0.0059520372860554296, 0.00594277707898679, 0.0059332933779316496,
             0.0059235860427285696, 0.0059136559376815603, 0.0059035029361686302,
             0.00589312792263204, 0.0058825307837483297, 0.0058717124242273003,
             0.00586067274379599, 0.0058494126675633397, 0.0058379321080513098,
             0.0058262320109022199, 0.0058143123011696303, 0.00580217394516636,
             0.0057898168802061603, 0.0057772420934128097, 0.0057644495340803499,
             0.0057514402102876103, 0.00573821408302028, 0.0057247721814604104,
             0.0057111144779874402, 0.0056972420230392501, 0.0056831548000816001,
             0.0056688538809657896, 0.00565433925992635, 0.0056396120303909203,
             0.0056246721970348804, 0.0056095208750309702, 0.0055941580791565096,
             0.0055785849465045103, 0.00556280150160386, 0.0055468089036499199,
             0.0055306071865607901, 0.0055141975318237901, 0.0054975799823712901,
             0.0054807557421802603, 0.0054637248628092699, 0.0054464885709314299,
             0.0054290469263295702, 0.0054114011785889298, 0.0053935513953001397,
             0.0053754988491867602, 0.0053572436152155498, 0.0053387869894855697,
             0.0053201290538919897, 0.0053012711281584003, 0.0052822133006437998,
             0.0052629569149581102, 0.0052435020654417498, 0.0052238501198665398,
             0.0052040011780531397, 0.00518395663222558, 0.0051637165871638397,
             0.0051432824598503001, 0.0051226543594824299, 0.00510183372812416,
             0.0050808206788265399, 0.0050596166790765904, 0.0050382218451916101,
             0.0050166376704429798, 0.0049948642738021302, 0.0049729031747072199,
             0.0049507544941454701, 0.0049284197781270097, 0.0049058991489885802,
             0.00488319417974197, 0.0048603049933776, 0.0048372331903648704,
             0.0048139788936205196, 0.00479054373155591, 0.0047669278262531603,
             0.0047431328345804002, 0.0047191588769884803, 0.0046950076393499299,
             0.00467067923964949, 0.0046461753933470899, 0.0046214962150858303,
             0.0045966434505341196, 0.0045716172100742896, 0.0045464192702454401,
             0.0045210497362033197, 0.0044955104160643196, 0.0044698014087417798,
             0.0044439245546838901, 0.0044178799454920696, 0.0043916694547526097,
             0.0043652931656277998, 0.00433875298570439, 0.0043120489885162304,
             0.0042851831165735101, 0.0042581554325255297, 0.0042309679147946198,
             0.0042036206138172296, 0.0041761155449878701, 0.0041484527451238597,
             0.0041206342677293801, 0.0040926601345120496, 0.0040645324383073601,
             0.0040362511841313198, 0.0040078185054639301, 0.0039792343889485902,
             0.00395050101012285, 0.0039216183354687899, 0.0038925885841034399,
             0.0038634117004416298, 0.00383408994882075, 0.0038046232495547701,
             0.0037750139139723698, 0.0037452618361135601, 0.00371536937621183,
             0.00368533639970758, 0.0036551653178090401, 0.00362485596486421,
             0.00359441080529778, 0.0035638296396892401, 0.0035331149881106302,
             0.0035022666144950199, 0.0034712870972013099, 0.0034401761604160898,
             0.00340893644365496, 0.0033775676280126199, 0.0033460724172862501,
             0.0033144504458618301, 0.0032827044852257602, 0.0032508341191376201,
             0.00321884219049483, 0.0031867282281785201, 0.0031544951505689599,
             0.00312214242704435, 0.0030896730559302, 0.0030570864420615398,
             0.0030243856686085701, 0.00299157007035751, 0.0029586428207129399,
             0.0029256031783842498, 0.00289245441295143, 0.0028591957004311902,
             0.00282583041314178, 0.0027923576371277499, 0.0027587808547117698,
             0.0027250990539355001, 0.0026913158351901099, 0.0026574300796303198,
             0.0026234455146880698, 0.0025893609047745601, 0.0025551801143720602,
             0.00252090178017944, 0.00248652991492768, 0.00245206301535766,
             0.0024175052550154002, 0.0023828549769665101, 0.0023481165297184999,
             0.00231328808724125, 0.0022783741889835199, 0.0022433728224190001,
             0.0022082887360539301, 0.0021731197111528101, 0.00213787072589754,
             0.0021025393329158499, 0.0020671307636284399, 0.00203164231639524,
             0.0019960795029244699, 0.0019604393378750799, 0.0019247276444412701,
             0.00188894111960767, 0.00185308593422461, 0.00181715842817174,
             0.0017811651621228201, 0.00174510207281587, 0.00170897616020232,
             0.0016727829037842101, 0.0016365298011697699, 0.0016002118106207301,
             0.0015638369968063301, 0.00152739972044591, 0.00149090869642164,
             0.0014543575961973099, 0.00141775588533881, 0.0013810964348205501,
             0.00134438958342722, 0.0013076272653904999, 0.0012708208437091899,
             0.00123396114713071, 0.00119706075108122, 0.00116010916727993,
             0.00112312042121534, 0.00108608243872211, 0.00104901099975,
             0.00101189209723806, 0.000974743661956659, 0.00093754929813201797,
             0.00090032961321354099, 0.00086306521178616303,
             0.00082578009089766095, 0.00078845101729864604,
             0.000751106368877295, 0.00071371789252934405,
             0.00067631976701736595, 0.00063887699702641697,
             0.000601431670945403, 0.00056393943987660905,
             0.00052645357440305005, 0.00048891621293663105,
             0.00045139717599785098, 0.00041381803609336402,
             0.00037627462290389801, 0.00033865494764251901,
             0.00030109921650763998, 0.00026343501249824199,
             0.00022588791300103599, 0.00018815907804198401,
             0.00015067346092076001, 0.00011278853882436201,
             7.5609315584839403e-05, 3.6758405990266602e-05,
             3.81471181758186e-06]))
                                        # Rescale from [-1,1] to [0,1]
        for xi in self.x:
            xi += 1.
            xi *= 0.5
        for wi in self.w: wi *= 0.5
	         	
                                        # Unit tests
if __name__ == '__main__':
    
    if True:                            # Integrals of various orders
    	qp = QuadratureCC()
    	print '%10s %10s %20s' % ('Level', '#nodes', 'Error')
    	for level in range(qp.nlevel()):
    	    print '%10d %10d %20.10g' % (level, qp.nnode(level),
              (qp.integrate(level, lambda x: abs(x-0.5)**3.) - 0.03125 )*0.03125)
    	print '%10s %10s %20.10g' % ('Exact', '', 0.)
    					   
    	for i,l in enumerate(qp.idx):
    	    print l			# Indices wrt finest rule
    					# Should be all 0.
    	    print qp.x[i] - qp.global_index_to_x(qp.idx[i])

    if True:                            # Test interpolation
        def f(x): return np.cos(4*np.pi*x)
        l  = 5
        xx = np.linspace(-1,1,101)
        ff, fq = np.zeros(101), np.zeros(101)
        for i,x in enumerate(xx):
            fq[i] = qp.interpolate(x, l, f)
            ff[i] = f(x)
        fp = np.zeros(qp.nnode(l))
        for i,x in enumerate(qp.x[l]):
            fp[i] = f(x)
        import matplotlib.pyplot as plt
        fig = plt.figure()
        ax  = fig.add_subplot(111)
        ax.plot(xx, ff, '-k')
        ax.plot(xx, fq, '-r')
        ax.plot(qp.x[l], fp, 'sk')
        fig.savefig('int_cc.pdf')
        
