\documentclass{beamer}

\mode<presentation>
{
  \usetheme{Antibes}
  \usecolortheme{beaver}
  % or ...

  \setbeamercovered{transparent}
  % or whatever (possibly just delete it)
}


\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage[compatibility=false]{caption}
\usepackage{subcaption}
\usepackage{physics}
\usepackage{amsmath}
\usepackage{amssymb}

%\usepackage{multimedia}
%\usepackage{movie9}


\newcommand{\expv}[1]{\ensuremath{\mathbb{E}[ #1]}}
\newcommand{\xs}[2]{\ensuremath{\Sigma_{#1}^{(#2)}}}
\newcommand{\intO}{\ensuremath{\int\limits_{4\pi}}}
\newcommand{\intz}{\ensuremath{\int\limits_0^1}}
\newcommand{\intf}{\ensuremath{\int\limits_{-\infty}^\infty}}
\newcommand{\intzf}{\ensuremath{\int\limits_{0}^\infty}}

\title[UQ in RAVEN] % (optional, use only with long paper titles)
{Advanced Methods in \\Stochastic Collocation for Polynomial Chaos\\in RAVEN}

%\subtitle
%{A Term Project}

\author[Talbot] % (optional, use only with lots of authors)
{Paul W. Talbot}%\inst{1}}


\institute[University of New Mexico] % (optional, but mostly needed)
{
  %\inst{1}%
  University of New Mexico%\\
  %\inst{2}
  %Idaho National Laboratory
}

\date[Jan 22 2016] % (optional, should be abbreviation of conference name)
{Dissertation Proposal, January 22nd 2016\\\vspace{10pt}\small Funded by a Laboratory Directed Research effort at Idaho National Laboratory}


\subject{Uncertainty Quantification}

\pgfdeclareimage[height=0.5cm]{university-logo}{../../graphics/unmlogo}
%\logo{\pgfuseimage{university-logo}}
\logo{\makebox[0.95\paperwidth]{
  \includegraphics[height=1cm]{../../graphics/INL}\hfill
    \includegraphics[height=0.5cm]{../../graphics/unmlogo}}

}

\addtobeamertemplate{navigation symbols}{}{
  \usebeamerfont{footline}%
  \usebeamercolor[fg]{footline}%
  \hspace{1em}%
  \insertframenumber/\inserttotalframenumber
}

\makeatletter
\def\beamer@tocaction@only#1{\only<.(1)>{\usebeamertemplate**{#1}}}
\define@key{beamertoc}{subsectionsonly}[]{\beamer@toc@subsectionstyle{show/only}\beamer@toc@subsubsectionstyle{show/shaded/hide}}
\makeatother

\begin{document}
\AtBeginSection[]{\begin{frame}{Outline}\vspace{-20pt}
  \tableofcontents[currentsection,hideothersubsections]%,subsectionsonly]
\end{frame}}
%\AtBeginSection[]{\begin{frame}{Outline}
%  \tableofcontents[subsectionsonly,pausesections]
%\end{frame}}

\begin{frame}
  \titlepage
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%
%        OUTLINE        %
%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Outline}{Discussion Points}
  \begin{columns}
  \begin{column}{0.1\textwidth}
  \end{column}
  \begin{column}{0.9\textwidth}
    \setcounter{tocdepth}{2}
    \tableofcontents[]
  \end{column}
  \end{columns}
\end{frame}
%\begin{frame}{Outline}{Discussion Points}\vspace{-20pt}
%  \tableofcontents[hideallsubsections]%[pausesections]
  % You might wish to add the option [pausesections]
%\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        BACKGROUND        % 10 minutes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Background}

\subsection{Terminology}
% describe uq in general
% introduce terminology
\begin{frame}{Background}{Terminology}
  \begin{itemize}
  \item Model - Mathematical representation
  \item Simulation/Code - Algorithms to Solve Model
  \item Output - Solution to Model \vspace{20pt}
  \item Input Space - Space Spanning Possible Input Values
  \item Response - Map of Input Space to Output Space
  \end{itemize}
\end{frame}

\begin{frame}{Background}{UQ}
  Understanding Simulations
  \begin{itemize}
    \item Verification - Is the code consistent?
      \begin{itemize}
        \item Spatial, Temporal Convergence
      \end{itemize}
    \item Validation - Does it match experiment?
      \begin{itemize}
        \item Fitting, Extrapolation
      \end{itemize}
    \item Uncertainty Quantification - Behavior of Response
      \begin{itemize}
        \item Response Surface Characterization
      \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Background}{Verification and Validation}
  \vspace{-50pt}
  \begin{figure}[h!]
    \centering
      \includegraphics[width=0.8\textwidth]{../../graphics/v_and_v_1}
  \end{figure}
\end{frame}

\begin{frame}{Background}{Uncertainty Quantification}
  \vspace{-20pt}
  \begin{figure}[h!]
    \centering
      \includegraphics[width=0.8\textwidth]{../../graphics/v_and_v_uq}
  \end{figure}
  \hfill Oberkampf and Roy, 2010
\end{frame}


\subsection{Raven}
\begin{frame}{Background}{RAVEN}\vspace{-20pt}
  \begin{itemize}
    \item (R)isk (A)nalysis (V)irtual (EN)vironment
    \item Verification and Validation
    \item Uncertainty Quantification
    \item Response Surfaces, Risk
    \item Reduced-Order Models
    \item Operates on Black-box Models
  \end{itemize}
  Goal: Add New UQ Methods to RAVEN
\end{frame}

\subsection{Intrusiveness}
% Galerkin/Adjoint methods vs non-intrusive
\begin{frame}{Background}{Intrusiveness}\vspace{-20pt}
  Two approaches to UQ:\vspace{10pt}
  \begin{itemize}
    \item Intrusive
       \begin{itemize}
         \item Interacts with Simulation Algorithms
         \item Examples: Stochastic Galerkin, Adjoint-Based
       \end{itemize}
    \item Non-Intrusive
      \begin{itemize}
        \item Agnostic of Code
        \item Example: Monte Carlo, Stochastic Collocation
      \end{itemize}
  \end{itemize}\vspace{10pt}
  For RAVEN, need non-intrusive algorithms
\end{frame}

\subsection{Sampling Strategies}
\begin{frame}{Sampling Strategies}{Non-Intrusive Sampling Strategies}
  \vspace{-20pt}
  \begin{columns}
  \begin{column}{0.6\textwidth}
  Monte Carlo
    \begin{itemize}
      \item Generate independent, identically-distributed samples
      \item Derive mean, variance, response surface
    \end{itemize}
  Latin Hypercube
    \begin{itemize}
      \item Distributed Monte Carlo
    \end{itemize}
  \end{column}
  \begin{column}{0.4\textwidth}
    \begin{figure}[h!]
      \centering
        \includegraphics[width=\textwidth]{../../graphics/mc}
      \end{figure} \vspace{-20pt}
    \begin{figure}[h!]
      \centering
        \includegraphics[width=\textwidth]{../../graphics/lhs}
    \end{figure}
  \end{column}
  \end{columns}
\end{frame}
% Monte Carlo and LHS
% gPC

\begin{frame}{Sampling Strategies}{Limitations}\vspace{-20pt}
  Monte Carlo common choice for UQ\vspace{10pt}
  \begin{itemize}
    \item Pro: Convergence agnostic of dimensionality
    \item Con: Convergence can take many, many samples
  \end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%         METHODS          % 20-30 minutes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methods}
%\begin{frame}{Methods}{Outline}\vspace{-20pt}
%  \tableofcontents[currentsection,hideothersubsections]%,subsectionsonly]
%\end{frame}


\subsection{UQ Methods}
\begin{frame}{Definitions}{}\vspace{-20pt}
  \begin{itemize}
    \item $N\in\mathbb{N^+}$ - Cardinality of Input Space
    \item Probabilty Space $(\Omega,\Theta,\rho)$, $Y:\Theta\to\mathbb{R}^N$
    \item $Y=(y_1,\cdots,y_N)$ - Uncertain Input Parameter Vector
    \item Subspaces $(\Omega_n,\Theta_n,\rho_n)$
    \item $Y\in\mathbb{R}^N$, $y_n\in\mathbb{R}\forall n\leq N,n\in\mathbb{N^+}$
    \item Members of $Y$ are uncorrelated
    \item $\rho(Y)=\prod_{n=1}^N \rho_n(y_n)$ - Joint Probability Density Function
    \vspace{10pt}
    \item $u(Y)$ - QoI as a function of Input Parameters $Y$
  \end{itemize}
\end{frame}


\subsubsection{SC for gPC}
\begin{frame}{Generalized Polynomial Chaos}{gPC}\vspace{-20pt}
  \begin{equation*}
    u(Y) = \sum_{k\in\Lambda} c_k \Phi_k(Y),
  \end{equation*}\vspace{-10pt}
  \begin{itemize}
    \item $\Lambda$ - a finite set of polynomial indices,
    \item $k=(k_1,\cdots,k_N)$ indexes $\Lambda$, $k_n\in\mathbb{N}^0$,
    \item $c_k\in\mathbb{R}$ - scalar coefficients,
    \item $\phi_{k_n}(y_n)$ - Gauss polys order $k_n$ orthonormal w.r.t $\rho_n(y_n)$,
    \item $\Phi_k(Y)=\prod_{n=1}^N\phi_{k_n}(y_n)$,
    \item $\Phi_k(Y)$ orthonormal w.r.t $\rho(Y)$ over $\Omega$.
  \end{itemize}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Truncated}\vspace{-20pt}
  In practice, truncate to some gPC level $L\in\mathbb{N^+}$,
  \begin{equation*}
    u(Y)\approx G_L[u](Y) \equiv \sum_{k\in\Lambda(L)} c_k \Phi_k(Y).
  \end{equation*}%\vspace{-10pt}
  Error is of order equal to the polynomial terms removed by truncation.
\end{frame}

\subsubsection{Polynomial Index Sets}
\begin{frame}{Generalized Polynomial Chaos}{Constructing $\Lambda(L)$}\vspace{-20pt}
  $\Lambda(L)$ is list of multidimensional polynomial indices $k$\vspace{25pt}\\
  For example, $N=3$:
  \begin{equation*}
    k = (3,1,2)\hspace{10pt}\to\hspace{10pt} \Phi_k(Y) = \phi_3(y_1)\phi_1(y_2)\phi_2(y_3).
  \end{equation*}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Constructing $\Lambda(L)$}%\vspace{-20pt}
  Na{\"i}ve choice for $\Lambda(L)$ is tensor product of all polynomials of order less than or equal to $L$,
  \begin{equation*}
      \Lambda_\text{TP}(L)=\Big\{k=(k_1,\cdots,k_N): \max_{1\leq n\leq N}k_n\leq L\Big\}.
  \end{equation*}
  Size of Index Set: $|\Lambda_\text{TP}(L)|=(L+1)^N$.
  \begin{table}[h]
    \centering
    \begin{tabular}{c c c c}
    (3,0) & (3,1) & (3,2) & (3,3) \\
    (2,0) & (2,1) & (2,2) & (2,3) \\
    (1,0) & (1,1) & (1,2) & (1,3) \\
    (0,0) & (0,1) & (0,2) & (0,3)
    \end{tabular}
    \caption{Tensor Product Index Set, $N=2,L=3$}
    \label{tab:TP}
  \end{table}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Constructing $\Lambda(L)$}%\vspace{-20pt}
  Common choice for $\Lambda(L)$: Total Degree of all polynomials of order less than or equal to $L$,
  \begin{equation*}
    \Lambda_\text{TD}(L)=\Big\{\bar p=(p_1,\cdots,p_N):\sum_{n=1}^N p_n \leq L\Big\}.
  \end{equation*}
  Size of Index Set: $|\Lambda_\text{TD}(L)|={L+N\choose N}$.
  \begin{table}[h]
    \centering
    \begin{tabular}{c c c c}
    (3,0) &       &       &       \\
    (2,0) & (2,1) &       &       \\
    (1,0) & (1,1) & (1,2) &       \\
    (0,0) & (0,1) & (0,2) & (0,3)
    \end{tabular}
    \caption{Total Degree Index Set, $N=2,L=3$}
    \label{tab:TD}
  \end{table}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Constructing $\Lambda(L)$}%\vspace{-20pt}
  Hyperbolic Cross: Limited by product of all polynomial orders,
  \begin{equation*}
    \Lambda_\text{HC}(L)=\Big\{\bar p=(p_1,\ldots,p_N):\prod_{n=1}^N p_n+1 \leq L+1\Big\}.
  \end{equation*}
  Index Set Bound: $|\Lambda_\text{HC}(L)|\leq (L+1)(1+\log(L+1))^{N-1}$.
  \begin{table}[h]
    \centering
    \begin{tabular}{c c c c}
    (3,0) &       &       &       \\
    (2,0) &       &       &       \\
    (1,0) & (1,1) &       &       \\
    (0,0) & (0,1) & (0,2) & (0,3)
    \end{tabular}
    \caption{Hyperbolic Cross Index Set, $N=2,L=3$}
    \label{tab:HC}
  \end{table}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Constructing $\Lambda(L)$}%\vspace{-20pt}
  Anisotropic Rules using weights $\alpha = (\alpha_1,\cdots,\alpha_N)$
  \begin{equation*}
    \tilde\Lambda_\text{TD}(L)=\Big\{\bar p=(p_1,\cdots,p_N):\sum_{n=1}^N \alpha_n p_n \leq \qty|\alpha|_1 L
  \Big\},
  \end{equation*}
  \begin{equation*}
    \tilde\Lambda_\text{HC}(L)=\Big\{\bar p=(p_1,\cdots,p_N):\prod_{n=1}^N \qty(p_n+1)^{\alpha_n} \leq
    \qty(L+1)^{\qty|\alpha|_1} \Big\}.
  \end{equation*}
  \begin{equation*}
    |\alpha|_1 \equiv \frac{\sum_{n=1}^N \alpha_n}{N}.
  \end{equation*}
\end{frame}


\subsubsection{Sparse Grid Quadrature}
\begin{frame}{Generalized Polynomial Chaos}{Sparse Grid Quadrature}%\vspace{-20pt}
  Necessary to find coefficients $c_k$,
  \begin{equation*}
    G[u](Y) = \sum_{k\in\Lambda(L)} c_k \Phi_k(Y).
  \end{equation*}%\vspace{-10pt}
  Using orthonormality of $\Phi_k(Y)$,
  \begin{equation*}
    c_k = \langle u(Y)\Phi_k(Y) \rangle = \int_\Omega \rho(Y) u(Y)\Phi_k(Y) dY
  \end{equation*}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Sparse Grid Quadrature}%\vspace{-20pt}
  The quadrature and polynomials to use depends on the distribution $\rho_n(y_n)$,
  \begin{table}[h]
    \centering
    \begin{tabular}{c|c}
      PDF Kind & Polynomials / Quadrature \\ \hline
      Uniform & Legendre \\
      Normal  & Hermite  \\
      Gamma   & Laguerre \\
      Beta    & Jacobi   
    \end{tabular}
  \end{table}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Order of Quadrature}%\vspace{-20pt}
  Determine order of quadrature
  \begin{equation*}
    \int_{\Omega_x} f(x)\rho(x)dx = \sum_{\ell=1}^\infty w_\ell f(x_\ell).
  \end{equation*}
  If $f(x)$ is a polynomial of order $2m-1$,
  \begin{equation*}
    \int_{\Omega_x} f(x)\rho(x)dx = \sum_{\ell=1}^m w_\ell f(x_\ell).
  \end{equation*}
  Let
  \begin{equation*}
    q^{m}[f(x)] \equiv \sum_{\ell=1}^m w_\ell f(x_\ell).
  \end{equation*}
  In our case (let $N$=1),
  \begin{equation*}
    c_k = \int_{\Omega} u(Y)\Phi(Y)\rho(Y)dY = q^m[u(Y)\Phi(Y)].
  \end{equation*}
  Unknown $m$.
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Order of Quadrature}\vspace{-20pt}
  \begin{equation*}
    c_k = \int_{\Omega} u(Y)\Phi(Y)\rho(Y)dY = q^m[u(Y)\Phi_k(Y)].
  \end{equation*}
  To determine $m$, replace $u(Y)=G[u](Y)$:
  \begin{align*}
    c_k &= q^m\left[\Phi_k(Y)\sum_{k'\in\Lambda(L)}c_{k'}\Phi_{k'}(Y)\right], \\
        &= q^m\left[c_k\Phi_k(Y)^2\right],\\
        &= q^m\left[\mathcal{O}(k^2)\right],
  \end{align*}
  so
  \begin{equation*}
    2m+1 = 2k \hspace{10pt}\to\hspace{10pt}m=k+\frac{1}{2}\approx m=k+1.
  \end{equation*}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Sparse Grid Quadrature}\vspace{-20pt}
  Multidimensional Quadrature
  \begin{itemize}
    \item Each point needs $N$ quadrature sets
    \item Ex. $N=2$, $k$=(4,4), need (5,5) quadratures
    \item Needed for each $k$ in $\Lambda$
  \end{itemize}
  \begin{columns}
  \begin{column}{0.6\linewidth}
  Tensor quadrature
  \begin{align*}
    Q^{M} &\equiv q^{m_1}_1 \otimes q^{m_2}_2 \otimes \cdots \otimes q^{m_N}_N,\\
                       &= \bigotimes_{n=1}^N q^{m_n}_n.
  \end{align*}
  \end{column}
  \begin{column}{0.4\linewidth}
    \begin{figure}[h!]
      \centering
        \includegraphics[width=\textwidth]{../../graphics/tpquad}
    \end{figure}
  \end{column}
  \end{columns}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Sparse Grid Quadrature}\vspace{-20pt}
Smolyak sparse grids $S[u](Y)$:
\begin{equation*}
  \text{Let }\Delta_k^{m}[f(x)] \equiv \qty(q_k^{m} - q_{k-1}^{m})[f(x)].
\end{equation*}
\vspace{10pt}
\begin{equation*}
  S^{M}_{\Lambda,N}[u(Y)\Phi_k(Y)] = \sum_{k\in\Lambda(L)} \left(\Delta_{k_1}^{m_1} \otimes \cdots \otimes
  \Delta_{k_N}^{m_N}\right)[u(Y)\Phi_k(Y)].
\end{equation*}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Sparse Grid Quadrature}%\vspace{-20pt}
  Equivalently,
\begin{equation*}
  S^{M}_{\Lambda,N}[u(Y)\Phi_k(Y)] = \sum_{k\in\Lambda(L)} s(k)\bigotimes_{n=1}^N
  q^{m_n}_n[u(Y)\Phi_k(Y)],
\end{equation*}
\begin{equation*}
  s(k) = \sum_{\substack{j=\{0,1\}^N,\\k+j\in\Lambda}} (-1)^{|j|_1},\hspace{10pt}|j|_1 \equiv \sum_{p\in j}p.
\end{equation*}
\begin{align*}
  c_k &= \langle u(Y)\Phi_k(Y) \rangle,\\
      &\approx S^{M}_{\Lambda,N}[u(Y)\Phi_k(Y)].
\end{align*}
\end{frame}

\begin{frame}{Generalized Polynomial Chaos}{Sparse Grid Quadrature}%\vspace{-20pt}
Comparison, $N=2$, $L=4$
    \begin{figure}[h!]
      \centering
       \hspace{-40pt}\includegraphics[width=1.15\textwidth]{../../graphics/sparse_plot}
    \end{figure}
\end{frame}

\subsubsection{Adaptive Sparse Grid}
\begin{frame}{Generalized Polynomial Chaos}{Adaptive Index Sets}%\vspace{-20pt}
Special property of gPC:
\begin{equation*}
  G[u](Y) = \sum_{k\in\Lambda}c_k\Phi_k(Y),
\end{equation*}
\begin{equation*}
  \text{mean}=\langle G[u](Y)\rangle = c_{\{0\}^N},
\end{equation*}
\begin{align*}
  \text{var} &=\langle G[u](Y)^2\rangle - c_{\{0\}^N}^2,\\
      &= \sum_{k\in\Lambda}c_k^2 - c_{\{0\}^N}^2.
\end{align*}
\end{frame}

\subsection{Physics Models}
\subsubsection{Tensor Polynomials}
\subsubsection{Attenuation}
\subsubsection{Neutron Diffusion}

\begin{frame}{Methods}{todo}
  todo
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        PROPOSAL          % 15-20 minutes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Proposal}

\subsection{Adaptive Sparse Grid}
\subsection{HDMR}
\subsection{Adaptive HDMR}
\subsection{Mammoth}
\subsubsection{RattleS$_\text{N}$ake}
\subsubsection{Bison}

\begin{frame}{Proposal}{todo}
  todo
\end{frame}

\end{document}






